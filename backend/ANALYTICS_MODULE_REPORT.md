# –û—Ç—á—ë—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Analytics Module v0 - –¢–ó ‚Ññ14

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. Backend: AnalyticsService ‚úÖ
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `getDashboard(dateFrom?, dateTo?)`:
- ‚úÖ –ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –¥–∞—Ç–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, —Ä–µ–∫–ª–∞–º–µ, –æ—Å—Ç–∞—Ç–∫–∞–º –∏ –æ—Ç–∑—ã–≤–∞–º

### 2. Backend: AnalyticsController ‚úÖ
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç:
- ‚úÖ `GET /api/analytics/dashboard` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–∞
- ‚úÖ Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `dateFrom?`, `dateTo?`
- ‚úÖ –ó–∞—â–∏—â—ë–Ω `JwtAuthGuard`
- ‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞

### 3. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö ‚úÖ

**–ü—Ä–æ–¥–∞–∂–∏ (Sales):**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ `FinanceReport`:
  - totalRevenue ‚Äî —Å—É–º–º–∞ revenue
  - totalOrders ‚Äî —Å—É–º–º–∞ quantity
  - avgCheck ‚Äî revenue / orders
  - totalRefunds ‚Äî —Å—É–º–º–∞ refunds

**–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å (Margin):**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ `FinanceReport` + `Sku.cost`:
  - totalCost ‚Äî —Å—É–º–º–∞ (Sku.cost * FinanceReport.quantity)
  - grossMargin ‚Äî totalRevenue - totalRefunds - totalCost
  - grossMarginPercent ‚Äî (grossMargin / totalRevenue) * 100

**–†–µ–∫–ª–∞–º–∞ (Advertising):**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ `AdStats`:
  - totalSpend ‚Äî —Å—É–º–º–∞ spend
  - roas ‚Äî revenue / spend (–∏–∑ AdStats)

**–û—Å—Ç–∞—Ç–∫–∏ (Stocks):**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ `Stock`:
  - totalSkus ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö SKU
  - totalQuantity ‚Äî —Å—É–º–º–∞ quantity
  - lowStockSkus ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SKU —Å quantity < 10

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ (Support):**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ `Review`:
  - totalReviews ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤
  - avgRating ‚Äî —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥
  - negativeReviews ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º ‚â§ 2

### 4. Frontend: –°—Ç—Ä–∞–Ω–∏—Ü–∞ /analytics ‚úÖ

**–°–µ–∫—Ü–∏—è 1: –ö–∞—Ä—Ç–æ—á–∫–∏ summary**
- ‚úÖ 6 –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ –≤–∏–¥–µ —Ä–µ—à—ë—Ç–∫–∏ 3x2:
  - Revenue
  - Orders
  - Gross Margin
  - Gross Margin %
  - Ad Spend
  - ROAS

**–°–µ–∫—Ü–∏—è 2: –ü—Ä–æ–¥–∞–∂–∏ (—Ç–∞–±–ª–∏—Ü–∞)**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: Date, Revenue, Orders, Refunds
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –ø–æ –¥–Ω—è–º –∏–∑ FinanceReport
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ

**–°–µ–∫—Ü–∏—è 3: –†–µ–∫–ª–∞–º–∞ (—Ç–∞–±–ª–∏—Ü–∞)**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: Date, Impressions, Clicks, CTR (computed), Spend, Orders, Revenue, ROAS (computed)
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ AdStats, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–∞–º

**–°–µ–∫—Ü–∏—è 4: –¢–æ–ø –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–≤—ã—Ö 10 –æ—Ç–∑—ã–≤–æ–≤ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º ‚â§ 2
- ‚úÖ –ö–æ–ª–æ–Ω–∫–∏: Date, SKU, Rating, Text (—Å –æ–±—Ä–µ–∑–∫–æ–π)

**–§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ**
- ‚úÖ Date range picker –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å" –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚úÖ
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å backend API
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `MainLayout`
- ‚úÖ Shadcn UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Card, Table, Button, Input, Label)

### 6. README –æ–±–Ω–æ–≤–ª—ë–Ω ‚úÖ
- ‚úÖ Backend README —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–¥–µ–ª AnalyticsModule
- ‚úÖ Frontend README —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ Analytics —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### Backend
```
backend/src/modules/analytics/
‚îú‚îÄ‚îÄ analytics.module.ts
‚îú‚îÄ‚îÄ analytics.service.ts
‚îî‚îÄ‚îÄ analytics.controller.ts
```

### Frontend
```
frontend/app/analytics/
‚îî‚îÄ‚îÄ page.tsx
```

## üìã API Endpoints

### Dashboard
- `GET /api/analytics/dashboard` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥–∞
  - Query: `dateFrom?`, `dateTo?`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, —Ä–µ–∫–ª–∞–º–µ, –æ—Å—Ç–∞—Ç–∫–∞–º –∏ –æ—Ç–∑—ã–≤–∞–º

## üìä –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

```json
{
  "sales": {
    "totalRevenue": 142000,
    "totalOrders": 820,
    "avgCheck": 173.17,
    "totalRefunds": 3200
  },
  "margin": {
    "totalCost": 67000,
    "grossMargin": 72000,
    "grossMarginPercent": 50.7
  },
  "advertising": {
    "totalSpend": 22000,
    "roas": 6.45
  },
  "stocks": {
    "totalSkus": 58,
    "totalQuantity": 12340,
    "lowStockSkus": 7
  },
  "support": {
    "totalReviews": 238,
    "avgRating": 4.3,
    "negativeReviews": 22
  }
}
```

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ - –í–°–ï –í–´–ü–û–õ–ù–ï–ù–´

1. ‚úÖ –ö–æ–¥ Analytics –º–æ–¥—É–ª—è (service/controller) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
2. ‚úÖ –ü—Ä–∏–º–µ—Ä JSON /analytics/dashboard –æ–ø–∏—Å–∞–Ω –≤ README
3. ‚úÖ –ö–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã /analytics (–∫–∞—Ä—Ç–æ—á–∫–∏ + —Ç–∞–±–ª–∏—Ü—ã) —Å–æ–∑–¥–∞–Ω
4. ‚úÖ –î–∞–Ω–Ω—ã–µ —Ç—è–Ω—É—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç–æ—è—â–∏—Ö —Ç–∞–±–ª–∏—Ü (FinanceReport, AdStats, Stock, Review)
5. ‚úÖ –ü—Ä–æ–µ–∫—Ç—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥–∞
```bash
curl -X GET "http://localhost:3001/api/analytics/dashboard?dateFrom=2025-01-01&dateTo=2025-01-31" \
  -b cookies.txt
```

### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```bash
curl -X GET "http://localhost:3001/api/analytics/dashboard" \
  -b cookies.txt
```

## üéØ –°—Ç–∞—Ç—É—Å

**‚úÖ Analytics Module v0 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- –ê–≥—Ä–µ–≥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (Finance, Advertising, Stock, Support)
- –ü—Ä–æ—Å—Ç—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ —Ç–∞–±–ª–∏—Ü
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –¥–∞—Ç–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã
- –ì–æ—Ç–æ–≤ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏







