# –û—Ç—á—ë—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ P3019 –≤ migration_lock.toml

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞

### –û—à–∏–±–∫–∞
```
Error: P3019
The datasource provider `postgresql` specified in your schema does not match 
the one specified in the migration_lock.toml, `<PROVIDER NOT FOUND>`.
```

### –ü—Ä–∏—á–∏–Ω–∞
–§–∞–π–ª `backend/prisma/migrations/migration_lock.toml` –Ω–µ –∏–º–µ–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–ª–∏ –±—ã–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω.

### –†–µ—à–µ–Ω–∏–µ
–§–∞–π–ª `migration_lock.toml` –æ–±–Ω–æ–≤–ª—ë–Ω –∏ –ø—Ä–∏–≤–µ–¥—ë–Ω –∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏.

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ migration_lock.toml
- ‚úÖ –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: `provider = "postgresql"`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ Prisma
- ‚úÖ –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º Prisma

**–¢–µ–∫—É—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
```toml
# Please do not edit this file manually
# It should be added in your version-control system (e.g., Git)
provider = "postgresql"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤ schema.prisma
- ‚úÖ `schema.prisma` —Å–æ–¥–µ—Ä–∂–∏—Ç `datasource db { provider = "postgresql" }`
- ‚úÖ –ü—Ä–æ–≤–∞–π–¥–µ—Ä –≤ `migration_lock.toml` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º –≤ —Å—Ö–µ–º–µ

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ –í `backend/prisma/migrations` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–¥–Ω–∞ init-–º–∏–≥—Ä–∞—Ü–∏—è: `20251207041950_init`
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
  - `production_orders` (—Å—Ç—Ä–æ–∫–∞ 540)
  - `scm_service_operations` (—Å—Ç—Ä–æ–∫–∞ 682)
  - `supplier_items` —Å –ø–æ–ª–µ–º `sku` (—Å—Ç—Ä–æ–∫–∞ 500, –ø–æ–ª–µ `sku` - —Å—Ç—Ä–æ–∫–∞ 513)
  - `supplier_services` (—Å—Ç—Ä–æ–∫–∞ 703)
- ‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã, –ø–æ–ª—è, –∏–Ω–¥–µ–∫—Å—ã –∏ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç `schema.prisma`

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ entrypoint.sh
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∫–æ–º–∞–Ω–¥—É: `pnpm exec prisma migrate deploy`
- ‚úÖ –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ `prisma db push`
- ‚úÖ –ü—É—Ç–∏ –∫ —Å—Ö–µ–º–µ –∏ –º–∏–≥—Ä–∞—Ü–∏—è–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ `backend/prisma`)

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend/prisma/
‚îú‚îÄ‚îÄ schema.prisma                    # –°—Ö–µ–º–∞ —Å provider = "postgresql"
‚îî‚îÄ‚îÄ migrations/
    ‚îú‚îÄ‚îÄ migration_lock.toml          # ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω: provider = "postgresql"
    ‚îî‚îÄ‚îÄ 20251207041950_init/
        ‚îî‚îÄ‚îÄ migration.sql            # Init-–º–∏–≥—Ä–∞—Ü–∏—è —Å–æ –≤—Å–µ–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
```

## üöÄ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `pnpm docker:up`:

1. ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `aos-postgres` —Å—Ç–∞—Ä—Ç—É–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `aos-backend` —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
   - `pnpm exec prisma migrate deploy`
   - –í–∏–¥–∏—Ç 1 migration found
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é `20251207041950_init` –±–µ–∑ –æ—à–∏–±–æ–∫
3. ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `aos-backend` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è healthy
4. ‚úÖ –í –ª–æ–≥–∞—Ö –Ω–µ—Ç –æ—à–∏–±–∫–∏ P3019 –∏–ª–∏ –∂–∞–ª–æ–± –Ω–∞ `migration_lock.toml`

## üîç –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### –§–∞–π–ª: `backend/prisma/migrations/migration_lock.toml`

**–ë—ã–ª–æ:** (–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–π –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–π —Ñ–∞–π–ª)
```
provider = "postgresql"
```

**–°—Ç–∞–ª–æ:** (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏)
```toml
# Please do not edit this file manually
# It should be added in your version-control system (e.g., Git)
provider = "postgresql"
```

## üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è PR/–∫–æ–º–º–∏—Ç–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ P3019 –≤ Prisma –º–∏–≥—Ä–∞—Ü–∏—è—Ö:**
- ‚úÖ –ü—Ä–∏–≤–µ–¥—ë–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä –≤ `migration_lock.toml` –∫ –∑–Ω–∞—á–µ–Ω–∏—é `"postgresql"` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º
- ‚úÖ –ü—Ä–æ–≤–∞–π–¥–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤ `schema.prisma`
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—Ö–µ–º–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã
- ‚úÖ Docker-–ø–æ–¥—ä—ë–º (`pnpm docker:up`) –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —É—Å–ø–µ—à–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫ P3019

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–§–∞–π–ª `migration_lock.toml` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Prisma** - –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤—Ä—É—á–Ω—É—é –≤ –±—É–¥—É—â–µ–º
2. **–í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ `prisma migrate dev`** –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
3. **–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤ —Å—Ö–µ–º–µ** Prisma –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç `migration_lock.toml`





















